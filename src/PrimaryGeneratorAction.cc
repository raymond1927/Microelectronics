//
// ********************************************************************
// * License and Disclaimer                                           *
// *                                                                  *
// * The  Geant4 software  is  copyright of the Copyright Holders  of *
// * the Geant4 Collaboration.  It is provided  under  the terms  and *
// * conditions of the Geant4 Software License,  included in the file *
// * LICENSE and available at  http://cern.ch/geant4/license .  These *
// * include a list of copyright holders.                             *
// *                                                                  *
// * Neither the authors of this software system, nor their employing *
// * institutes,nor the agencies providing financial support for this *
// * work  make  any representation or  warranty, express or implied, *
// * regarding  this  software system or assume any liability for its *
// * use.  Please see the license in the file  LICENSE  and URL above *
// * for the full disclaimer and the limitation of liability.         *
// *                                                                  *
// * This  code  implementation is the result of  the  scientific and *
// * technical work of the GEANT4 collaboration.                      *
// * By using,  copying,  modifying or  distributing the software (or *
// * any work based  on the software)  you  agree  to acknowledge its *
// * use  in  resulting  scientific  publications,  and indicate your *
// * acceptance of all terms of the Geant4 Software license.          *
// ********************************************************************
//
// -------------------------------------------------------------------
// -------------------------------------------------------------------

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....

#include "PrimaryGeneratorAction.hh"
#include "G4SystemOfUnits.hh"

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....

PrimaryGeneratorAction::PrimaryGeneratorAction() {
    G4int n_particle = 1;
    fParticleGun = new G4ParticleGun(n_particle);

    // default gun parameters
    fParticleGun->SetParticleEnergy(18. * keV);
    fParticleGun->SetParticleMomentumDirection(G4ThreeVector(0., 0., 1.));
    fParticleGun->SetParticlePosition(G4ThreeVector(0., 0., -0.501 * um));

    particleCount = 0;
    sr90Energies = std::vector<G4double>{
            0.00000, 0.00010, 0.00011, 0.00012, 0.00013, 0.00014, 0.00015, 0.00016, 0.00018, 0.00020, 0.00022,
            0.00024, 0.00026, 0.00028, 0.00030, 0.00032, 0.00036, 0.00040, 0.00045, 0.00050, 0.00055, 0.00060,
            0.00065, 0.00070, 0.00075, 0.00080, 0.00085, 0.00090, 0.00100, 0.00110, 0.00120, 0.00130, 0.00140,
            0.00150, 0.00160, 0.00180, 0.00200, 0.00220, 0.00240, 0.00260, 0.00280, 0.00300, 0.00320, 0.00360,
            0.00400, 0.00450, 0.00500, 0.00550, 0.00600, 0.00650, 0.00700, 0.00750, 0.00800, 0.00850, 0.00900,
            0.01000, 0.01100, 0.01200, 0.01300, 0.01400, 0.01500, 0.01600, 0.01800, 0.02000, 0.02200, 0.02400,
            0.02600, 0.02800, 0.03000, 0.03200, 0.03600, 0.04000, 0.04500, 0.05000, 0.05500, 0.06000, 0.06500,
            0.07000, 0.07500, 0.08000, 0.08500, 0.09000, 0.10000, 0.11000, 0.12000, 0.13000, 0.14000, 0.15000,
            0.16000, 0.18000, 0.20000, 0.22000, 0.24000, 0.26000, 0.28000, 0.30000, 0.32000, 0.36000, 0.40000,
            0.45000, 0.50000, 0.54600};
    sr90Probability = std::vector<G4double>{
            2.951E+00, 2.949E+00, 2.949E+00, 2.949E+00, 2.949E+00, 2.948E+00, 2.948E+00, 2.948E+00, 2.948E+00,
            2.947E+00, 2.947E+00, 2.947E+00, 2.947E+00, 2.946E+00, 2.946E+00, 2.946E+00, 2.945E+00, 2.944E+00,
            2.944E+00, 2.943E+00, 2.942E+00, 2.941E+00, 2.941E+00, 2.940E+00, 2.939E+00, 2.938E+00, 2.938E+00,
            2.937E+00, 2.935E+00, 2.934E+00, 2.932E+00, 2.931E+00, 2.929E+00, 2.928E+00, 2.926E+00, 2.923E+00,
            2.920E+00, 2.917E+00, 2.914E+00, 2.911E+00, 2.908E+00, 2.905E+00, 2.902E+00, 2.896E+00, 2.890E+00,
            2.882E+00, 2.875E+00, 2.867E+00, 2.866E+00, 2.864E+00, 2.863E+00, 2.861E+00, 2.860E+00, 2.859E+00,
            2.857E+00, 2.855E+00, 2.852E+00, 2.849E+00, 2.846E+00, 2.843E+00, 2.841E+00, 2.838E+00, 2.833E+00,
            2.827E+00, 2.822E+00, 2.818E+00, 2.813E+00, 2.809E+00, 2.804E+00, 2.800E+00, 2.793E+00, 2.786E+00,
            2.777E+00, 2.770E+00, 2.763E+00, 2.756E+00, 2.750E+00, 2.743E+00, 2.737E+00, 2.731E+00, 2.725E+00,
            2.719E+00, 2.706E+00, 2.693E+00, 2.679E+00, 2.663E+00, 2.647E+00, 2.629E+00, 2.609E+00, 2.563E+00,
            2.508E+00, 2.441E+00, 2.361E+00, 2.267E+00, 2.157E+00, 2.031E+00, 1.887E+00, 1.549E+00, 1.155E+00,
            6.310E-01, 1.821E-01, 0.000E+00
    };
    y90Energies = std::vector<G4double>{
            0.00000, 0.00010, 0.00011, 0.00012, 0.00013, 0.00014, 0.00015, 0.00016, 0.00018,
            0.00020, 0.00022, 0.00024, 0.00026, 0.00028, 0.00030, 0.00032, 0.00036, 0.00040,
            0.00045, 0.00050, 0.00055, 0.00060, 0.00065, 0.00070, 0.00075, 0.00080, 0.00085,
            0.00090, 0.00100, 0.00110, 0.00120, 0.00130, 0.00140, 0.00150, 0.00160, 0.00180,
            0.00200, 0.00220, 0.00240, 0.00260, 0.00280, 0.00300, 0.00320, 0.00360, 0.00400,
            0.00450, 0.00500, 0.00550, 0.00600, 0.00650, 0.00700, 0.00750, 0.00800, 0.00850,
            0.00900, 0.01000, 0.01100, 0.01200, 0.01300, 0.01400, 0.01500, 0.01600, 0.01800,
            0.02000, 0.02200, 0.02400, 0.02600, 0.02800, 0.03000, 0.03200, 0.03600, 0.04000,
            0.04500, 0.05000, 0.05500, 0.06000, 0.06500, 0.07000, 0.07500, 0.08000, 0.08500,
            0.09000, 0.10000, 0.11000, 0.12000, 0.13000, 0.14000, 0.15000, 0.16000, 0.18000,
            0.20000, 0.22000, 0.24000, 0.26000, 0.28000, 0.30000, 0.32000, 0.36000, 0.40000,
            0.45000, 0.50000, 0.55000, 0.60000, 0.65000, 0.70000, 0.75000, 0.80000, 0.85000,
            0.90000, 1.00000, 1.10000, 1.20000, 1.30000, 1.40000, 1.50000, 1.60000, 1.80000,
            2.00000, 2.20000, 2.28010};
    y90Probability = std::vector<G4double>{
            3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01, 3.379E-01,
            3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01,
            3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01,
            3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.380E-01, 3.381E-01, 3.381E-01,
            3.381E-01, 3.381E-01, 3.381E-01, 3.381E-01, 3.381E-01, 3.382E-01, 3.382E-01, 3.382E-01, 3.382E-01,
            3.383E-01, 3.383E-01, 3.383E-01, 3.385E-01, 3.388E-01, 3.391E-01, 3.394E-01, 3.398E-01, 3.401E-01,
            3.404E-01, 3.410E-01, 3.416E-01, 3.422E-01, 3.428E-01, 3.435E-01, 3.441E-01, 3.447E-01, 3.459E-01,
            3.472E-01, 3.484E-01, 3.497E-01, 3.510E-01, 3.523E-01, 3.536E-01, 3.550E-01, 3.577E-01, 3.605E-01,
            3.641E-01, 3.677E-01, 3.713E-01, 3.750E-01, 3.788E-01, 3.825E-01, 3.863E-01, 3.900E-01, 3.938E-01,
            3.975E-01, 4.050E-01, 4.124E-01, 4.197E-01, 4.269E-01, 4.340E-01, 4.410E-01, 4.479E-01, 4.612E-01,
            4.740E-01, 4.862E-01, 4.978E-01, 5.089E-01, 5.194E-01, 5.294E-01, 5.387E-01, 5.559E-01, 5.709E-01,
            5.868E-01, 5.998E-01, 6.102E-01, 6.181E-01, 6.238E-01, 6.274E-01, 6.292E-01, 6.292E-01, 6.276E-01,
            6.245E-01, 6.141E-01, 5.979E-01, 5.756E-01, 5.466E-01, 5.099E-01, 4.647E-01, 4.105E-01, 2.771E-01,
            1.276E-01, 1.403E-02, 0.000E+00
    };
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....

PrimaryGeneratorAction::~PrimaryGeneratorAction() {
    delete fParticleGun;
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....

void PrimaryGeneratorAction::GeneratePrimaries(G4Event *anEvent) {

//    fParticleGun->SetParticleEnergy()

    fParticleGun->GeneratePrimaryVertex(anEvent);
}
